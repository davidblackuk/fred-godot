[gd_scene load_steps=17 format=2]

[ext_resource path="res://Player.tscn" type="PackedScene" id=1]
[ext_resource path="res://tiles.tres" type="TileSet" id=2]
[ext_resource path="res://Door.tscn" type="PackedScene" id=3]
[ext_resource path="res://Ladder.tscn" type="PackedScene" id=4]
[ext_resource path="res://controls/game/SkyBox.tscn" type="PackedScene" id=5]
[ext_resource path="res://Palette.tscn" type="PackedScene" id=6]
[ext_resource path="res://Levels/LevelBase.gd" type="Script" id=7]
[ext_resource path="res://sprites/victims/victim.tscn" type="PackedScene" id=8]
[ext_resource path="res://controls/game/ScoreHud.tscn" type="PackedScene" id=9]
[ext_resource path="res://sprites/enemies/Enemy.tscn" type="PackedScene" id=10]
[ext_resource path="res://sprites/enemies/EnemyPath2D.gd" type="Script" id=11]
[ext_resource path="res://controls/MovingPlatforms/MovingPlatform.tscn" type="PackedScene" id=15]

[sub_resource type="GDScript" id=1]
script/source = "tool
extends Node2D

export(String, FILE, \"*.tscn\") var next_level

export(Color, RGB) var door_tint = Color.white setget set_door_tint, get_door_tint

#
# Fred has walked into the door and triggered entry to the next level
#
func _on_Area2D_body_entered(body):
	if body.name == \"Player\":
		# warning-ignore:return_value_discarded
		get_tree().change_scene(next_level) # Replace with function body.

#
# Animate the shutter then when complete, remove the static body 
# collision that prevents pred from entering and hitting the Area2d
# that initiates the level change
#
func _level_complete():
	var animator = get_node(\"Area2D/AnimationPlayer\")
	animator.play(\"Roller\")
	yield(animator, \"animation_finished\")
	get_node(\"StaticBody2D\").set_collision_mask_bit(0, false)


func get_door_tint():
	return get_node(\"Area2D/Roller\").modulate

func set_door_tint(value):
	get_node(\"Area2D/Roller\").modulate = value
	get_node(\"Area2D/Door Top\").modulate = value
	get_node(\"Area2D/Door Bottom\").modulate = value
"

[sub_resource type="Curve2D" id=2]
_data = {
"points": PoolVector2Array( 0, 0, 0, 0, 168, 288, 0, 0, 0, 0, 168, 608, 0, 0, 0, 0, 168, 288 )
}

[sub_resource type="Curve2D" id=3]
_data = {
"points": PoolVector2Array( 0, 0, 0, 0, 168, 288, 0, 0, 0, 0, 168, 424, 0, 0, 0, 0, 168, 608, 0, 0, 0, 0, 168, 408, 0, 0, 0, 0, 168, 288 )
}

[sub_resource type="GDScript" id=4]
script/source = "extends Path2D

# Called every frame. 'delta' is the elapsed time since the previous frame.
func _process(delta):
	var follower = get_node(\"./PathFollow2D\")
	follower.set_offset(follower.get_offset() + 100 * delta)
"

[node name="Level 3" type="Node2D"]
script = ExtResource( 7 )

[node name="SkyBox" parent="." instance=ExtResource( 5 )]
color = Color( 0.447059, 0.0470588, 0.447059, 1 )

[node name="ScoreHud" parent="." instance=ExtResource( 9 )]
level_name = "third times the charm"

[node name="Tiles" type="TileMap" parent="."]
position = Vector2( 0, 192 )
tile_set = ExtResource( 2 )
cell_size = Vector2( 32, 32 )
collision_layer = 2
collision_mask = 0
format = 1
tile_data = PoolIntArray( -393216, 19, 0, -393185, 19, 0, -327680, 19, 0, -327649, 19, 0, -262144, 19, 0, -262113, 19, 0, -196608, 19, 0, -196577, 19, 0, -131072, 19, 0, -131041, 19, 0, -65536, 19, 0, -65505, 19, 0, 0, 19, 0, 31, 19, 0, 65536, 19, 0, 65567, 19, 0, 131072, 19, 0, 131103, 19, 0, 196608, 19, 0, 196639, 19, 0, 262144, 19, 0, 262175, 19, 0, 327680, 19, 0, 327711, 19, 0, 393216, 19, 0, 393247, 19, 0, 458752, 19, 0, 458783, 19, 0, 524288, 19, 0, 524319, 19, 0, 589824, 19, 0, 589844, 23, 0, 589845, 23, 0, 589846, 23, 0, 589847, 23, 0, 589848, 23, 0, 589849, 23, 0, 589850, 23, 0, 589851, 23, 0, 589852, 23, 0, 589853, 23, 0, 589854, 23, 0, 589855, 19, 0, 655360, 19, 0, 655391, 19, 0, 720896, 19, 0, 720927, 19, 0, 786432, 19, 0, 786463, 19, 0, 851968, 19, 0, 851969, 27, 0, 851970, 27, 0, 851972, 27, 0, 851973, 27, 0, 851976, 30, 0, 851977, 30, 0, 851981, 30, 0, 851999, 19, 0, 917504, 19, 0, 983040, 19, 0, 1048576, 19, 0, 1114112, 20, 0, 1114113, 21, 0, 1114114, 21, 0, 1114115, 21, 0, 1114116, 21, 0, 1114117, 21, 0, 1114118, 21, 0, 1114119, 21, 0, 1114120, 21, 0, 1114121, 21, 0, 1114122, 21, 0, 1114123, 21, 0, 1114124, 21, 0, 1114125, 21, 0, 1114126, 21, 0, 1114127, 21, 0, 1114128, 21, 0, 1114129, 21, 0, 1114130, 21, 0, 1114131, 21, 0, 1114132, 21, 0, 1114133, 21, 0, 1114134, 21, 0, 1114135, 21, 0, 1114136, 21, 0, 1114137, 21, 0, 1114138, 21, 0, 1114139, 21, 0, 1114140, 21, 0, 1114141, 21, 0, 1114142, 21, 0, 1114143, 22, 0 )

[node name="Door" parent="." instance=ExtResource( 3 )]
position = Vector2( 1008, 656 )
script = SubResource( 1 )
next_level = "res://Levels/Level 001.tscn"
door_tint = Color( 1, 1, 0.0705882, 1 )

[node name="Ladders" type="Node2D" parent="."]
position = Vector2( 0, 192 )

[node name="Ladder 1" type="Node2D" parent="Ladders"]

[node name="Ladder" parent="Ladders/Ladder 1" instance=ExtResource( 4 )]
position = Vector2( 112, 528 )
ladder_type = 1

[node name="Ladder2" parent="Ladders/Ladder 1" instance=ExtResource( 4 )]
position = Vector2( 112, 496 )

[node name="Ladder3" parent="Ladders/Ladder 1" instance=ExtResource( 4 )]
position = Vector2( 112, 464 )

[node name="Ladder4" parent="Ladders/Ladder 1" instance=ExtResource( 4 )]
position = Vector2( 112, 432 )

[node name="Ladder5" parent="Ladders/Ladder 1" instance=ExtResource( 4 )]
position = Vector2( 112, 400 )

[node name="Ladder6" parent="Ladders/Ladder 1" instance=ExtResource( 4 )]
position = Vector2( 112, 368 )
ladder_type = 2

[node name="Ladder 2" type="Node2D" parent="Ladders"]

[node name="Ladder16" parent="Ladders/Ladder 2" instance=ExtResource( 4 )]
position = Vector2( 688, 240 )
ladder_type = 1

[node name="Ladder17" parent="Ladders/Ladder 2" instance=ExtResource( 4 )]
position = Vector2( 688, 208 )

[node name="Ladder18" parent="Ladders/Ladder 2" instance=ExtResource( 4 )]
position = Vector2( 688, 176 )

[node name="Ladder19" parent="Ladders/Ladder 2" instance=ExtResource( 4 )]
position = Vector2( 688, 144 )

[node name="Ladder20" parent="Ladders/Ladder 2" instance=ExtResource( 4 )]
position = Vector2( 688, 112 )

[node name="Ladder21" parent="Ladders/Ladder 2" instance=ExtResource( 4 )]
position = Vector2( 688, 80 )

[node name="Ladder22" parent="Ladders/Ladder 2" instance=ExtResource( 4 )]
position = Vector2( 688, 48 )
ladder_type = 2

[node name="Ladder 4" type="Node2D" parent="Ladders"]
position = Vector2( 192, 0 )
__meta__ = {
"_edit_group_": true
}

[node name="Ladder16" parent="Ladders/Ladder 4" instance=ExtResource( 4 )]
position = Vector2( 688, 240 )
ladder_type = 1

[node name="Ladder17" parent="Ladders/Ladder 4" instance=ExtResource( 4 )]
position = Vector2( 688, 208 )

[node name="Ladder18" parent="Ladders/Ladder 4" instance=ExtResource( 4 )]
position = Vector2( 688, 176 )

[node name="Ladder19" parent="Ladders/Ladder 4" instance=ExtResource( 4 )]
position = Vector2( 688, 144 )

[node name="Ladder20" parent="Ladders/Ladder 4" instance=ExtResource( 4 )]
position = Vector2( 688, 112 )

[node name="Ladder21" parent="Ladders/Ladder 4" instance=ExtResource( 4 )]
position = Vector2( 688, 80 )

[node name="Ladder22" parent="Ladders/Ladder 4" instance=ExtResource( 4 )]
position = Vector2( 688, 48 )
ladder_type = 2

[node name="Player" parent="." instance=ExtResource( 1 )]
position = Vector2( 110.501, 699.896 )

[node name="Victims" type="Node2D" parent="."]

[node name="Victim" parent="Victims" instance=ExtResource( 8 )]
position = Vector2( 824, 432 )
sprite_tint = Color( 1, 1, 0, 1 )

[node name="Victim2" parent="Victims" instance=ExtResource( 8 )]
position = Vector2( 168, 698.96 )
sprite_tint = Color( 1, 1, 0, 1 )

[node name="Palette" parent="." instance=ExtResource( 6 )]
position = Vector2( 72.009, 811.995 )

[node name="Enemies" type="Node2D" parent="."]

[node name="Path2D" type="Path2D" parent="Enemies"]
position = Vector2( 168, 96 )
curve = SubResource( 2 )
script = ExtResource( 11 )
__meta__ = {
"_edit_group_": true
}

[node name="PathFollow2D" type="PathFollow2D" parent="Enemies/Path2D"]
position = Vector2( 168, 368.408 )
rotation = -7.79733e-06
offset = 80.42
rotate = false

[node name="Enemy" parent="Enemies/Path2D/PathFollow2D" instance=ExtResource( 10 )]
sprite_tint = Color( 0.0705882, 0.854902, 0.0705882, 1 )

[node name="Path2D2" type="Path2D" parent="Enemies"]
position = Vector2( 330, 90 )
curve = SubResource( 3 )
script = SubResource( 4 )
__meta__ = {
"_edit_group_": true
}

[node name="PathFollow2D" type="PathFollow2D" parent="Enemies/Path2D2"]
position = Vector2( 168, 422.215 )
rotation = -7.79733e-06
offset = 505.786
rotate = false

[node name="Enemy" parent="Enemies/Path2D2/PathFollow2D" instance=ExtResource( 10 )]
animation_speed = 0.8
sprite_tint = Color( 1, 1, 0, 1 )

[node name="MovingPlatforms" type="Node2D" parent="."]

[node name="MovingPlatform" parent="MovingPlatforms" instance=ExtResource( 15 )]
position = Vector2( 258.361, 621.847 )

[node name="Platform" parent="MovingPlatforms/MovingPlatform" index="0"]
position = Vector2( -0.861237, -154.824 )

[node name="PathFollow2D" parent="MovingPlatforms/MovingPlatform/Path2D" index="0"]
position = Vector2( -0.861231, -154.824 )
offset = 423.117

[node name="MovingPlatform2" parent="MovingPlatforms" instance=ExtResource( 15 )]
position = Vector2( 416, 624 )

[node name="Platform" parent="MovingPlatforms/MovingPlatform2" index="0"]
position = Vector2( -1.67645, -60.6617 )

[node name="PathFollow2D" parent="MovingPlatforms/MovingPlatform2/Path2D" index="0"]
position = Vector2( -1.67645, -60.6617 )
offset = 141.039

[node name="MovingPlatform3" parent="MovingPlatforms" instance=ExtResource( 15 )]
position = Vector2( 576, 624 )

[node name="Platform" parent="MovingPlatforms/MovingPlatform3" index="0"]
position = Vector2( -1.97992, -13.8243 )

[node name="PathFollow2D" parent="MovingPlatforms/MovingPlatform3/Path2D" index="0"]
position = Vector2( -1.97994, -13.8244 )
offset = 282.078
[connection signal="level_complete" from="." to="Door" method="_level_complete"]
[connection signal="ladder_status_changed" from="Ladders/Ladder 1/Ladder" to="Player" method="_ladder_status_changed"]
[connection signal="ladder_status_changed" from="Ladders/Ladder 1/Ladder2" to="Player" method="_ladder_status_changed"]
[connection signal="ladder_status_changed" from="Ladders/Ladder 1/Ladder3" to="Player" method="_ladder_status_changed"]
[connection signal="ladder_status_changed" from="Ladders/Ladder 1/Ladder4" to="Player" method="_ladder_status_changed"]
[connection signal="ladder_status_changed" from="Ladders/Ladder 1/Ladder5" to="Player" method="_ladder_status_changed"]
[connection signal="ladder_status_changed" from="Ladders/Ladder 1/Ladder6" to="Player" method="_ladder_status_changed"]
[connection signal="ladder_status_changed" from="Ladders/Ladder 2/Ladder16" to="Player" method="_ladder_status_changed"]
[connection signal="ladder_status_changed" from="Ladders/Ladder 2/Ladder17" to="Player" method="_ladder_status_changed"]
[connection signal="ladder_status_changed" from="Ladders/Ladder 2/Ladder18" to="Player" method="_ladder_status_changed"]
[connection signal="ladder_status_changed" from="Ladders/Ladder 2/Ladder19" to="Player" method="_ladder_status_changed"]
[connection signal="ladder_status_changed" from="Ladders/Ladder 2/Ladder20" to="Player" method="_ladder_status_changed"]
[connection signal="ladder_status_changed" from="Ladders/Ladder 2/Ladder21" to="Player" method="_ladder_status_changed"]
[connection signal="ladder_status_changed" from="Ladders/Ladder 2/Ladder22" to="Player" method="_ladder_status_changed"]
[connection signal="ladder_status_changed" from="Ladders/Ladder 4/Ladder16" to="Player" method="_ladder_status_changed"]
[connection signal="ladder_status_changed" from="Ladders/Ladder 4/Ladder17" to="Player" method="_ladder_status_changed"]
[connection signal="ladder_status_changed" from="Ladders/Ladder 4/Ladder18" to="Player" method="_ladder_status_changed"]
[connection signal="ladder_status_changed" from="Ladders/Ladder 4/Ladder19" to="Player" method="_ladder_status_changed"]
[connection signal="ladder_status_changed" from="Ladders/Ladder 4/Ladder20" to="Player" method="_ladder_status_changed"]
[connection signal="ladder_status_changed" from="Ladders/Ladder 4/Ladder21" to="Player" method="_ladder_status_changed"]
[connection signal="ladder_status_changed" from="Ladders/Ladder 4/Ladder22" to="Player" method="_ladder_status_changed"]
[connection signal="victim_rescued" from="Victims/Victim" to="." method="_on_victim_rescued"]
[connection signal="victim_rescued" from="Victims/Victim2" to="." method="_on_victim_rescued"]
[connection signal="fred_is_dead" from="Enemies/Path2D/PathFollow2D/Enemy" to="Player" method="_fred_is_dead"]
[connection signal="fred_is_dead" from="Enemies/Path2D2/PathFollow2D/Enemy" to="Player" method="_fred_is_dead"]

[editable path="MovingPlatforms/MovingPlatform"]

[editable path="MovingPlatforms/MovingPlatform2"]

[editable path="MovingPlatforms/MovingPlatform3"]
